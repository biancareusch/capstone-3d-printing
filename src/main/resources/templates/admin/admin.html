<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head th:include="partials/header_partial :: head">
    <title id="pageTitle">Admin Dashboard</title>
</head>
<body class="colorBackground">
<nav th:replace="partials/navbar :: navbar"></nav>

<h1 class="mt-3">Admin Dashboard</h1>
<h2 class="adminSubHeadings">All Posts</h2>

<div class="allposts backgroundDiv p-3" style="border: black 2px solid; max-width:50%;" th:each="post : ${allPosts}">
<a th:href="@{/files/{id}(id=${post.id})}" th:text="${post.title}"></a>
    <p th:text="${post.description}"></p>
    <form th:action="@{/files/{id}/flag(id=${post.id})}" th:method="post">
        <button th:type="submit" class="btn btn-outline-danger p-1 m-1">Flag Post</button>
    </form>
    <form th:action="@{/files/{id}/delete(id=${post.id})}" th:method="delete">
        <button th:type="submit" class="btn btn-outline-danger p-1 m-1">Delete Post</button>
    </form>
</div>
<h2 class="adminSubHeadings">All admins</h2>
<div class="allUsers backgroundDiv p-3" style="border: black 2px solid" th:each="admin : ${allAdmins}">
    <a th:href="@{/profile/{id}(id=${admin.id})}" th:text="${admin.username}"></a>
    <p th:text="${admin.joinedAt}"></p>
    <form th:action="@{/users/{id}/removeAdmin(id=${admin.id})}" th:method="post">
        <button th:type="submit" class="btn btn-outline-danger p-1 m-1">Remove from admins</button>
    </form>
</div>

<h2 class="adminSubHeadings">All active Users</h2>
<div class="allUsers backgroundDiv p-3" style="border: black 2px solid" th:each="user : ${allUsers}">
    <a th:href="@{/profile/{id}(id=${user.id})}" th:text="${user.username}"></a>
    <p th:text="${user.joinedAt}"></p>
    <form th:action="@{/users/{id}/flag(id=${user.id})}" th:method="post">
        <button th:type="submit" class="btn btn-outline-danger p-1 m-1">Flag User</button>
    </form>
    <form th:action="@{/users/{id}/deactivate(id=${user.id})}" th:method="post">
        <button th:type="submit" class="btn btn-outline-danger p-1 m-1">Deactivate User</button>
    </form>
    <form th:action="@{/users/{id}/makeAdmin(id=${user.id})}" th:method="post">
        <button th:type="submit" class="btn btn-outline-danger p-1 m-1">Make Admin</button>
    </form>
</div>

<h2 class="adminSubHeadings">Flagged Posts</h2>
<div class="allFlaggedPosts backgroundDiv p-3" style="border: black 2px solid" th:each="post : ${flaggedPosts}">
<a th:href="@{/files/{id}(id=${post.id})}" th:text="${post.title}"></a>
    <p th:text="${post.description}"></p>
    <p th:text="${post.isFlagged()}"></p>
    <form th:action="@{/files/{id}/unflag(id=${post.id})}" th:method="post">
        <button th:type="submit" class="btn btn-outline-success p-1 m-1">Unflag Post</button>
    </form>
</div>
<h2 class="adminSubHeadings">Flagged Users</h2>
<div class="allFlaggedUsers backgroundDiv p-3"  style="border: black 2px solid" th:each="user : ${flaggedUsers}">
    <a th:href="@{/profile/{id}(id=${user.id})}" th:text="${user.username}"></a>
    <p th:text="${user.joinedAt}"></p>
    <p th:text="${user.isFlagged()}"></p>
    <form th:action="@{/users/{id}/unflag(id=${user.id})}" th:method="post">
        <button th:type="submit" class="btn btn-outline-success p-1 m-1">Unflag User</button>
    </form>
</div>
<h2 class="adminSubHeadings">Deactivated Users</h2>
<div class="allDeactivatedUsers backgroundDiv p-3"  style="border: black 2px solid" th:each="deUser : ${deactivatedUsers}">
    <a th:href="@{/profile/{id}(id=${deUser.id})}" th:text="${deUser.username}"></a>
    <p th:text="${deUser.joinedAt}"></p>
    <p th:text="${deUser.active}"></p>
    <form th:action="@{/users/{id}/activate(id=${deUser.id})}" th:method="post">
        <button th:type="submit" class="btn btn-outline-success p-1 m-1">Re-activate User</button>
    </form>
</div>
<script th:replace="partials/partials_scripts :: script"></script>
<footer th:replace="partials/footer_partial :: footer"></footer>
</body>
</html>
